# Author: Wintershade <Wintershade AT google mail DOT com>
# Contributor: Konrad <konrad AT knauber DOT name>
# Contributor: Luka Perkov <archlinux <at> lukaperkov <dOt> net>
# Contirbutor: Fernando M <f <at> beford.net>

pkgname=rpm-org
pkgver=4.9.1.1
pkgrel=1
pkgdesc="RPM Package Manager - RPM.org fork, used in major RPM distros"
arch=('i686' 'x86_64')
url=("http://www.rpm.org/")
license=('GPL')
depends=('lua' 'file' 'nss' 'perl' 'python2')
conflicts=('rpm' 'rpmextract')
provides=('rpm=${pkgver}' 'rpmextract=1.0-4')
source=(http://rpm.org/releases/rpm-4.9.x/rpm-${pkgver}.tar.bz2
	'rpmextract.sh')
md5sums=('de64e7410721aa8e377adb8430cfc9e2'
	'a7b527e4c210e66ef72532c606072e0d')


build() {
	cd ${srcdir}/rpm-${pkgver}
	./configure --localstatedir=/var --prefix=/usr --without-selinux --disable-rpath --with-external-db --enable-python CPPFLAGS="`pkg-config --cflags nss`" PYTHON=python2
	make
}

package() {
	cd ${srcdir}/rpm-${pkgver}
	make prefix=${pkgdir}/usr localstatedir=${pkgdir}/var install
	rmdir ${pkgdir}/var/tmp
	install -m755 ${srcdir}/rpmextract.sh ${pkgdir}/usr/bin/
}
